---
import Layout from "../layouts/Layout.astro";
import Navbar from "../components/Navbar";
import AnnouncementBar from "../components/AnnouncementBar";
import Footer from "../components/Footer.astro";
import BackgroundPulse from "../components/BackgroundPulse";
import { resolvedContent as CONTENT } from "../utils/config";

// Safe fallback for Astro.site
const siteUrl = Astro.site || "https://adapthub.in";
---

<Layout 
  title={CONTENT.metadata.contact.title}
  description={CONTENT.metadata.contact.description}
  keywords={CONTENT.metadata.contact.keywords}
>
  <script slot="head" type="application/ld+json" is:inline set:html={JSON.stringify({
    "@context": "https://schema.org",
    "@type": "ContactPage",
    "@id": new URL("contact/#webpage", siteUrl).href,
    "url": new URL("contact/", siteUrl).href,
    "name": CONTENT.metadata.contact.title,
    "description": CONTENT.metadata.contact.description,
  })}></script>

  <AnnouncementBar client:load transition:persist />
  <Navbar client:load transition:persist />

  <main id="main-content" class="relative isolate pt-32 md:pt-40 pb-32 overflow-hidden min-h-[100svh] bg-void selection:bg-brand-teal/30 selection:text-white">
    
    {/* ── Environment & Atmosphere ── */}
    <BackgroundPulse client:load />

    {/* Cinematic Film Grain */}
    <svg class="absolute inset-0 w-full h-full pointer-events-none z-[1] opacity-[0.035]" aria-hidden="true">
      <filter id="contact-grain">
        <feTurbulence type="fractalNoise" baseFrequency="0.75" numOctaves="4" stitchTiles="stitch" />
        <feColorMatrix type="saturate" values="0" />
      </filter>
      <rect width="100%" height="100%" filter="url(#contact-grain)" />
    </svg>

    {/* Ambient Architectural Grid Lines (Minimalist) */}
    <div class="absolute inset-0 pointer-events-none flex justify-center z-[1] opacity-30 overflow-hidden" aria-hidden="true">
      <div class="w-full max-w-[1800px] h-full flex justify-between px-4 sm:px-6 md:px-12 lg:px-24">
        <div class="w-px h-full bg-gradient-to-b from-transparent via-white/[0.05] to-transparent"></div>
        <div class="w-px h-full bg-gradient-to-b from-transparent via-white/[0.05] to-transparent hidden lg:block ml-[41.666%]"></div>
        <div class="w-px h-full bg-gradient-to-b from-transparent via-white/[0.05] to-transparent hidden lg:block ml-[50%]"></div>
        <div class="w-px h-full bg-gradient-to-b from-transparent via-white/[0.05] to-transparent"></div>
      </div>
    </div>

    <div class="container mx-auto px-4 sm:px-6 md:px-12 lg:px-24 relative z-10 max-w-[1800px] mt-12 md:mt-24">
      
      {/* ── Asymmetric Brutalist Layout ── */}
      <div class="grid grid-cols-1 lg:grid-cols-12 gap-16 lg:gap-0 items-start">
        
        {/* Left Column: Context & Typography */}
        <div class="lg:col-span-5 relative">
          
          <header class="mb-16 md:mb-24 page-stagger" style="--i:0">


            <h1 class="text-[3.5rem] sm:text-5xl md:text-6xl lg:text-7xl font-serif text-white tracking-tighter leading-none mb-8">
              Contact <br />
              <span class="italic text-brand-teal block pb-2 sm:ml-8 mt-2 md:mt-4">AdaptHub.</span>
            </h1>
            
            <p class="text-zinc-400 font-sans text-lg md:text-xl max-w-md leading-[1.7] tracking-wide mt-8">
              Reach out directly for platform questions, business queries, and bug reports. Every message gets a personal response.
            </p>
          </header>

          {/* Monumental Direct Mail Route */}
          <div class="page-stagger" style="--i:1">
            <div class="flex items-center gap-4 mb-6">
              <span class="font-mono text-[10px] uppercase tracking-[0.25em] text-zinc-400">
                [ Direct Routing ]
              </span>
              <div class="h-px w-12 bg-white/10"></div>
            </div>

            <a 
              href={CONTENT.links.support} 
              class="group relative inline-block outline-none focus-visible:text-brand-teal active:scale-[0.98] transition-transform duration-300"
            >
              <span class="block text-2xl sm:text-3xl md:text-4xl lg:text-[2.5rem] font-serif text-zinc-300 group-hover:text-white transition-colors duration-500 break-all leading-none pb-2">
                {CONTENT.links.support.replace("mailto:", "")}
              </span>
              {/* Precision Reveal Underline */}
              <span class="absolute bottom-0 left-0 w-full h-[1px] bg-white/10" aria-hidden="true"></span>
              <span class="absolute bottom-0 left-0 w-full h-[1px] bg-brand-teal transform scale-x-0 group-hover:scale-x-100 transition-transform duration-700 origin-left ease-[cubic-bezier(0.16,1,0.3,1)]" aria-hidden="true"></span>
            </a>
          </div>

        </div>

        {/* Center Gap: Structural Whitespace (lg:col-span-1) is left deliberately empty */}

        {/* Right Column: The Naked Form Container */}
        <div class="lg:col-start-7 lg:col-span-6 relative page-stagger" style="--i:2">
          


          <div class="relative bg-white/[0.01] backdrop-blur-sm border border-white/[0.05] p-6 sm:p-10 lg:p-14 transition-colors duration-700 hover:bg-white/[0.02] hover:border-white/10">
            
            {/* Form Header */}
            <div class="mb-10 lg:mb-12">
              <h2 class="font-serif text-2xl lg:text-3xl text-white tracking-tight">
                Send a Message
              </h2>
            </div>

            {/* Form Injection Wrapper */}
            <div class="relative min-h-[250px]">

              {/* Minimalist Loading State Indicator (Hidden when iframe loads and bg goes solid/opaque if Tally background isn't transparent, or sits behind if it is. Tally's script also handles hiding loaders usually, but since we rely on transparent background, we'll use a CSS animation fading out or just keep it minimal behind) */}
              <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none -z-10" aria-hidden="true">
                 <div class="flex items-center gap-3 opacity-60">
                    <span class="w-1.5 h-1.5 rounded-full bg-brand-teal animate-pulse"></span>
                    <span class="font-mono text-[10px] text-zinc-400 uppercase tracking-[0.2em] animate-pulse">Establishing Connection...</span>
                 </div>
              </div>
              
              <iframe 
                data-tally-src="https://tally.so/embed/A7dQXz?alignLeft=1&hideTitle=1&dynamicHeight=1" 
                loading="lazy" 
                width="100%" 
                height="286" 
                style="border: none; display: block;"
                title="Contact AdaptHub Support"
                class="relative z-10 w-full"
                onload="this.previousElementSibling.style.display='none';"
              ></iframe>
            </div>

            {/* End-to-End Marker */}
            <div class="mt-8 pt-8 border-t border-white/[0.05] flex justify-end">
              <span class="font-mono text-[9px] text-zinc-500 uppercase tracking-[0.25em] flex items-center gap-2">
                <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" aria-hidden="true"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></svg>
                Encrypted Connection
              </span>
            </div>

          </div>

          {/* Tally Script Injection */}
          <script is:inline>
            var d=document,w="https://tally.so/widgets/embed.js",v=function(){"undefined"!=typeof Tally?Tally.loadEmbeds():d.querySelectorAll("iframe[data-tally-src]:not([src])").forEach((function(e){e.src=e.dataset.tallySrc}))};if("undefined"!=typeof Tally)v();else if(d.querySelector('script[src="'+w+'"]')==null){var s=d.createElement("script");s.src=w,s.onload=v,s.onerror=v,d.body.appendChild(s);}
          </script>
        </div>

      </div>
    </div>
  </main>
  
  <Footer />
</Layout>
